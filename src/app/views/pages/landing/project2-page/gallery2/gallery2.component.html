<div class="gallery-section">
  <h1 class="gallery-title">GALLERY</h1>
  <hr class="line">
  <div *ngIf="viewAll">
    <!-- Collapsible filter for mobile -->
    <div class="gallery-filter-accordion" *ngIf="isMobile; else desktopFilters">
      <button class="filter-toggle-btn" (click)="toggleFilterAccordion()" aria-expanded="{{filterAccordionOpen}}" aria-controls="filter-list">
        <span>Filter by Category</span>
        <i class="feather" [ngClass]="{'icon-chevron-down': !filterAccordionOpen, 'icon-chevron-up': filterAccordionOpen}"></i>
      </button>
      <div class="filter-list" [class.open]="filterAccordionOpen" id="filter-list">
        <button *ngFor="let cat of categories" class="gallery-btn" [class.selected]="filter === cat.value" (click)="filterImages(cat.value)">{{cat.label}}</button>
      </div>
    </div>
    <ng-template #desktopFilters>
      <div class="gallery-filter-bar">
        <button *ngFor="let cat of categories" class="gallery-btn" [class.selected]="filter === cat.value" (click)="filterImages(cat.value)">{{cat.label}}</button>
      </div>
    </ng-template>
  </div>
  <div class="gallery-grid">
    <div class="gallery-card" *ngFor="let image of viewAll ? filteredImages : filteredImages.slice(0, 4); let i = index" tabindex="0" (click)="openLightbox(i)" (keydown.enter)="openLightbox(i)">
      <div class="gallery-img-wrapper">
        <img [src]="image.src" [alt]="image.alt" />
        <div class="gallery-img-overlay">
          <div class="gallery-img-category">{{image.category}}</div>
          <div class="gallery-img-alt">{{image.alt}}</div>
        </div>
      </div>
    </div>
  </div>
  <button *ngIf="!viewAll && filteredImages.length > 4" class="toggle-gallery-btn" (click)="toggleViewAll()">View All</button>
  <button *ngIf="viewAll" class="toggle-gallery-btn" (click)="toggleViewAll()">Show Less</button>
</div>